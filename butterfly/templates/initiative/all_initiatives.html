{% extends 'base.html' %}
{% load forms %}
{% load static %}

{% block content %}
    <h1 class="w3-text-dark-grey w3-center"><b>get INVOLVED and CHANGE the FEATURE</b></h1>
{% if request.user.is_authenticated %}
    <div style="display: flex; justify-content: center">
    <a class="w3-button w3-padding w3-btn w3-round w3-blue w3-top" style="width: 96%" href="{% url 'add initiative' %}"><i class="fa fa-plus" aria-hidden="true"></i> ADD NEW INITIATIVE</a>
    </div>
{% endif %}

<div class="w3-container w3-margin">
    <div class="w3-text-dark-grey w3-display-topmiddle w3-animate-zoom w3-round-large w3-sand"
                 style="display:none;z-index:5;width: 80%; height: auto" id="filterMenu">
        <button onclick="closeFilterMenu()" class="w3-button w3-large w3-right w3-margin w3-round">Close &times;</button>
        <div class="w3-container w3-text-dark-grey">
            <h3 class="w3-top w3-center"><b>FILTERS</b></h3>
            <form method="get" class="w3-container">
                <div class="w3-container w3-margin w3-large" style="display: inline-block">
                    <label class="w3-text-grey w3-large" style="margin-bottom: 30px">Category: </label>
                    <p>{{ initiatives_list.form.category }}</p>
                </div>
                <div class="w3-container w3-margin w3-large" style="display: inline-block">
                    <label class="w3-text-grey w3-large" style="margin-bottom: 30px">Suitable for:</label>
                    <p>{{ initiatives_list.form.suitable_for }}</p>
                </div>
                <div class="w3-container w3-margin w3-large" style="display: inline-block">
                    <p>
                        <label class="w3-text-grey w3-large" style="margin-bottom: 30px">Start date:</label>
                        <span class="w3-margin">{{ initiatives_list.form.from_date }}</span>
                    </p>
                    <p>
                    <label class="w3-text-grey w3-large" style="margin-bottom: 30px">End date:</label>
                    <span class="w3-margin">{{ initiatives_list.form.to_date }}</span>
                    </p>
                    <p>
                       <label class="w3-text-grey w3-large" style="margin-bottom: 30px">Region:</label>
                       <span class="w3-margin">{{ initiatives_list.form.region }}</span>
                    </p>
                </div>
                <input type="submit" value="Filter" class="w3-button w3-padding w3-btn w3-round-large w3-2017-navy-peony">
            </form>
        </div>
    </div>
    <div class="w3-padding">
         <button class="w3-left w3-button w3-padding w3-btn w3-round w3-2017-navy-peony"
                 onclick="openFilterMenu()"><i class="fa fa-filter" aria-hidden="true"></i> FILTERS</button>
        <a href="{% url 'all initiatives' %}"
           class="w3-button w3-right w3-btn w3-round w3-border w3-border-grey"
           ><i class="fa fa-times" aria-hidden="true"></i> CLEAR FILTERS</a>
    </div>
    <div class="w3-overlay" onclick="w3_close()" style="cursor:pointer" id="myOverlay"></div>
</div>

<div class="w3-display-container" style="height: 80px; margin-top: 80px;">
    <div class="w3-display-middle" style="width: 70%">
        <form method="post">
            {{ search_form.title_filed|form_field_class:'w3-input w3-sand w3-border w3-round'|form_field_styles:'width: 90%' }}
            {% csrf_token %}
            <button type="submit" class="w3-display-right w3-button w3-btn w3-round w3-2017-navy-peony">SUBMIT</button>
        </form>
    </div>
</div>
 <div class="w3-row-padding w3-margin">
     {% for initiative in initiatives %}
     <div class="w3-col s12 m6 l4">
         <div class="w3-card-4 w3-round">
             <div class="w3-container w3-center w3-padding">
             {% if initiative.image %}
                 <img src="{{ initiative.image }}" alt="Lights" style="height: 350px; max-width:100%" class="w3-round">
             {% else %}
                 <img src="{% static 'images/pic_butterfly.png' %}" alt="Lights" style="height: 350px; max-width:100%"
                      class="w3-round">
             {% endif %}
             </div>
             <div class="w3-container w3-center w3-text-dark-grey">
                 <p class="w3-large" style="height: 50px">
                     {% if initiative.is_expired %}
                     <span class="w3-tag w3-round w3-red w3-margin-right">Expired</span>
                     {% else %}
                     <span class="w3-tag w3-round w3-green w3-margin-right">Active</span>
                     {% endif %}
                     {{ initiative.title|upper }}
                 </p>
             </div>
            <div class="w3-container w3-left w3-text-grey w3-margin-left">
                <p>Category: <span class="w3-text-dark-grey">{{ initiative.category|upper }}</span></p>
                <p>Region: <span class="w3-text-dark-grey">{{ initiative.region|upper }}</span></p>
                <p>Suitable for: <span class="w3-text-dark-grey">{{ initiative.suitable_for|upper }}</span></p>
            </div>
            <div class="w3-container w3-right w3-text-grey">
                <p>From: <span class="w3-text-dark-grey">{{ initiative.from_date|upper }}</span></p>
                <p>To: <span class="w3-text-dark-grey">{{ initiative.to_date|upper }}</span></p>
                <p>Participants: <span class="w3-text-dark-grey">{{ initiative.view_count|upper }}</span></p>
            </div>
             <div class="w3-container w3-text-dark-grey">
                 <p class="w3-large" style="height: 150px">{{ initiative.description|truncatechars:300}}</p>
             </div>
             <a class="w3-button w3-round w3-block w3-large w3-2017-navy-peony w3-margin-bottom" href="{% url 'details initiative' pk=initiative.pk %}"><b>More . . .</b></a>
         </div>
     </div>
     {% endfor %}
 </div>
    {% if initiatives.has_other_pages %}
      <div class="w3-center">
        <div class="w3-bar w3-xlarge w3-text-dark-grey">
        {% if initiatives.has_previous %}
        <a href="?page={{ initiatives.previous_page_number }}" class="w3-bar-item w3-button">&laquo;</a>
        {% endif %}
        {% for i in initiatives.paginator.page_range %}
            {% if initiatives.number == i %}
            <a href="{{ i }}" class="w3-button">{{ i }}</a>
            {% else %}
            <a href="?page={{ i }}" class="w3-button">{{ i }}</a>
            {% endif %}
        {% endfor %}
        {% if initiatives.has_next %}
            <a href="?page={{ initiatives.next_page_number }}" class="w3-button">&raquo;</a>
        {% endif %}
        </div>
      </div>
    {% endif %}

{% endblock %}